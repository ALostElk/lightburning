<view class="page-container" style="padding-top: {{statusBarHeight + 44}}px">
  
  <view class="search-header" style="top: {{statusBarHeight}}px">
    <view class="nav-back-btn" bindtap="goBack">
      <text class="back-arrow">â€¹</text>
    </view>
    
    <view class="search-capsule">
      <view class="search-icon-css"></view>
      <input 
        class="search-input"
        type="text"
        placeholder="æœç´¢è¿åŠ¨ (å¦‚: è·‘æ­¥)"
        placeholder-class="input-placeholder"
        value="{{keyword}}"
        bindinput="onSearchInput"
        bindfocus="onSearchFocus"
        confirm-type="search"
      />
      <view class="clear-btn" wx:if="{{keyword}}" bindtap="clearSearch">Ã—</view>
    </view>
  </view>

  <scroll-view scroll-y class="search-body">
    
    <view class="results-section" wx:if="{{keyword}}">
      <view class="section-title-sm">æœç´¢ç»“æœ</view>
      
      <view class="exercise-list" wx:if="{{results.length > 0}}">
        <block wx:for="{{results}}" wx:key="id">
          <view class="exercise-card" bindtap="addExercise" data-exercise="{{item}}">
            <view class="ex-icon-box">{{item.emoji}}</view>
            <view class="ex-info">
              <text class="ex-name">{{item.name}}</text>
              <text class="ex-meta">æ¶ˆè€—çº¦ {{item.caloriesPerMin}} kcal/åˆ†</text>
            </view>
            <view class="add-btn-circle">
              <view class="plus-icon"></view>
            </view>
          </view>
        </block>
      </view>

      <view class="empty-state" wx:elif="{{!isSearching}}">
        <text class="empty-text">æœªæ‰¾åˆ°ç›¸å…³è¿åŠ¨</text>
      </view>
    </view>

    <view class="recommend-section" wx:else>
      
      <view class="history-group" wx:if="{{recentSearches.length > 0}}">
        <view class="group-header">
          <text class="group-title">æœ€è¿‘æœç´¢</text>
          <view class="clear-icon" bindtap="clearRecentSearches">ğŸ—‘ï¸</view>
        </view>
        <view class="tag-cloud">
          <view class="glass-tag" wx:for="{{recentSearches}}" wx:key="*this" bindtap="onRecentSearchTap" data-keyword="{{item}}">
            {{item}}
          </view>
        </view>
      </view>

      <view class="filter-scroll">
        <view 
          class="filter-chip {{selectedExerciseType === 'aerobic' ? 'active' : ''}}" 
          bindtap="switchExerciseType" data-type="aerobic">ğŸƒ æœ‰æ°§</view>
        <view 
          class="filter-chip {{selectedExerciseType === 'strength' ? 'active' : ''}}" 
          bindtap="switchExerciseType" data-type="strength">ğŸ’ª åŠ›é‡</view>
        <view 
          class="filter-chip {{selectedExerciseType === 'flexibility' ? 'active' : ''}}" 
          bindtap="switchExerciseType" data-type="flexibility">ğŸ§˜ æ‹‰ä¼¸</view>
        <view 
          class="filter-chip {{selectedExerciseType === 'sports' ? 'active' : ''}}" 
          bindtap="switchExerciseType" data-type="sports">âš½ çƒç±»</view>
      </view>

      <view class="exercise-list animate-fade-in">
        <block wx:for="{{presetExercises}}" wx:key="id">
          <view 
            class="exercise-card" 
            wx:if="{{item.type === selectedExerciseType}}"
            bindtap="addExercise" 
            data-exercise="{{item}}"
          >
            <view class="ex-icon-box">{{item.emoji}}</view>
            <view class="ex-info">
              <text class="ex-name">{{item.name}}</text>
              <text class="ex-meta">æ¶ˆè€—çº¦ {{item.caloriesPerMin}} kcal/åˆ†</text>
            </view>
            <view class="add-btn-circle">
              <view class="plus-icon"></view>
            </view>
          </view>
        </block>
      </view>
      
      <view style="height: 100rpx;"></view>
    </view>

  </scroll-view>

  <view class="duration-modal {{showDurationModal ? 'show' : ''}}" catchtap="closeDurationModal">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">æœ¬æ¬¡è¿åŠ¨æ—¶é•¿</text>
        <view class="modal-close" bindtap="closeDurationModal">Ã—</view>
      </view>

      <view class="modal-info">
        <view class="modal-emoji">{{currentExercise.emoji}}</view>
        <view class="modal-name">{{currentExercise.name}}</view>
      </view>

      <view class="slider-box">
        <view class="slider-header">
          <text>æŒç»­æ—¶é—´</text>
          <text class="slider-value">{{durationInput}} <text class="unit">åˆ†é’Ÿ</text></text>
        </view>
        <slider 
          class="custom-slider" 
          min="5" max="180" step="5" 
          value="{{durationInput}}" 
          activeColor="#FF6B35" 
          backgroundColor="#FFF1E7"
          block-size="24"
          bindchanging="onDurationChange" 
          bindchange="onDurationChange"
        />
        <view class="quick-tags">
          <view class="quick-tag" bindtap="setDuration" data-val="15">15åˆ†</view>
          <view class="quick-tag" bindtap="setDuration" data-val="30">30åˆ†</view>
          <view class="quick-tag" bindtap="setDuration" data-val="45">45åˆ†</view>
          <view class="quick-tag" bindtap="setDuration" data-val="60">60åˆ†</view>
        </view>
      </view>

      <view class="burn-preview">
        <view class="burn-label">é¢„è®¡æ¶ˆè€—</view>
        <view class="burn-value">
          {{estimatedCalories}} <text class="burn-unit">kcal</text>
        </view>
      </view>

      <view class="modal-action">
        <view class="confirm-btn" bindtap="confirmAddExercise">ç¡®è®¤è®°å½•</view>
      </view>
    </view>
  </view>

</view>
