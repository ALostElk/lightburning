<!--pages/recipe-recommend/index.wxml-->
<view class="container" style="width: 750rpx; display: flex; box-sizing: border-box; position: relative; left: 0rpx; top: 0rpx; height: 10810rpx">
  
  <!-- æ ‡ç­¾åˆ‡æ¢ -->
  <view class="tabs-container">
    <view class="tabs" style="height: 91rpx; display: flex; box-sizing: border-box; width: 670rpx">
      <view 
        wx:for="{{tabs}}" 
        wx:key="key"
        class="tab-item {{recommendType === item.key ? 'active' : ''}}"
        data-type="{{item.key}}"
        bindtap="onTabChange"
       style="width: 174rpx; display: block; box-sizing: border-box">
        <text class="tab-icon">{{item.icon}}</text>
        <text class="tab-label">{{item.label}}</text>
      </view>
    </view>
  </view>

  <!-- AIæ™ºèƒ½å»ºè®®ï¼ˆä»…åœ¨æ™ºèƒ½æ¨èæ¨¡å¼æ˜¾ç¤ºï¼‰ -->
  <view wx:if="{{recommendType === 'ai' && aiSuggestions.length > 0}}" class="ai-suggestions">
    <view class="ai-title">
      <text class="ai-icon">ğŸ¤–</text>
      <text>AI è¥å…»åˆ†æ</text>
    </view>
    
    <view 
      wx:for="{{aiSuggestions}}" 
      wx:key="type"
      class="suggestion-item severity-{{item.severity}}"
    >
      <text class="suggestion-icon">{{item.icon}}</text>
      <text class="suggestion-message">{{item.message}}</text>
    </view>
  </view>

  <!-- åˆ·æ–°æŒ‰é’® -->
  <view class="refresh-section">
    <button class="btn-refresh" bindtap="onRefresh" style="width: 343rpx; display: block; box-sizing: border-box; left: 0rpx; top: 0rpx">
      <text class="refresh-icon">ğŸ”„</text>
      <text>æ¢ä¸€æ‰¹æ¨è</text>
    </button>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">æ­£åœ¨ä¸ºæ‚¨ç”Ÿæˆä¸ªæ€§åŒ–æ¨è...</text>
  </view>

  <!-- é£Ÿè°±åˆ—è¡¨ -->
  <view wx:else class="recipe-list">
    <view 
      wx:for="{{recipes}}" 
      wx:key="id"
      class="recipe-card"
      data-id="{{item.id}}"
      bindtap="onRecipeClick"
    >
      <!-- é£Ÿè°±å›¾ç‰‡ -->
      <view class="recipe-image-container">
        <image class="recipe-image" src="{{item.image}}" mode="aspectFill" />
        <view class="recipe-score">
          <text class="score-icon">â­</text>
          <text class="score-value">{{item.recommendScore}}</text>
        </view>
      </view>

      <!-- é£Ÿè°±ä¿¡æ¯ -->
      <view class="recipe-info">
        <view class="recipe-header">
          <text class="recipe-name">{{item.name}}</text>
          <view class="recipe-actions">
            <view 
              class="action-btn"
              catchtap="onFavoriteClick"
              data-id="{{item.id}}"
              data-index="{{index}}"
            >
              <text class="action-icon">{{item.isFavorited ? 'â¤ï¸' : 'ğŸ¤'}}</text>
            </view>
          </view>
        </view>

        <text class="recipe-description">{{item.description}}</text>

        <!-- è¥å…»ä¿¡æ¯ -->
        <view class="nutrition-info">
          <view class="nutrition-item">
            <text class="nutrition-icon">ğŸ”¥</text>
            <text class="nutrition-value">{{item.calories}}</text>
            <text class="nutrition-unit">å¡</text>
          </view>
          <view class="nutrition-item">
            <text class="nutrition-icon">ğŸ’ª</text>
            <text class="nutrition-value">{{item.protein}}</text>
            <text class="nutrition-unit">gè›‹ç™½</text>
          </view>
          <view class="nutrition-item">
            <text class="nutrition-icon">ğŸš</text>
            <text class="nutrition-value">{{item.carbs}}</text>
            <text class="nutrition-unit">gç¢³æ°´</text>
          </view>
          <view class="nutrition-item">
            <text class="nutrition-icon">ğŸ¥‘</text>
            <text class="nutrition-value">{{item.fat}}</text>
            <text class="nutrition-unit">gè„‚è‚ª</text>
          </view>
        </view>

        <!-- æ ‡ç­¾ -->
        <view class="recipe-tags" style="height: 0rpx; display: block; box-sizing: border-box">
          <view 
            wx:for="{{item.tags}}" 
            wx:key="*this"
            wx:for-item="tag"
            class="tag {{tag === 'é«˜è›‹ç™½' ? 'tag-protein' : tag === 'ä½å¡' || tag === 'ä½è„‚' ? 'tag-lowcal' : tag === 'ç´ é£Ÿ' ? 'tag-veg' : ''}}"
           style="width: 156rpx; display: block; box-sizing: border-box; position: relative; left: 325rpx; top: -222rpx">
            {{tag}}
          </view>
        </view>

        <!-- çƒ¹é¥ªä¿¡æ¯ -->
        <view class="cooking-info">
          <text class="cooking-time">â±ï¸ {{item.cookingTime}}åˆ†é’Ÿ</text>
          <text class="cooking-difficulty">ğŸ‘¨â€ğŸ³ {{item.difficulty}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{!loading && recipes.length === 0}}" class="empty-state">
    <text class="empty-icon">ğŸ½ï¸</text>
    <text class="empty-text">æš‚æ— æ¨èé£Ÿè°±</text>
    <text class="empty-hint">è¯·å®Œå–„æ‚¨çš„ä¸ªäººä¿¡æ¯ä»¥è·å¾—æ›´å¥½çš„æ¨è</text>
  </view>

</view>

