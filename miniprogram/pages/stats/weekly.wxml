<!-- pages/stats/weekly.wxml -->
<view class="page">

  <!-- 1. 顶部日期范围 (浮动) -->
  <view class="header-range">
    <view class="range-pill">{{weekRangeText}}</view>
  </view>

  <!-- 2. 本周核心数据 (大卡片) -->
  <view class="glass-card big-stat-card">
    <view class="card-header-clean">
      <text class="section-title">本周概览</text>
      <text class="header-tag">{{summary.goalRate}}% 达标</text>
    </view>
    
    <view class="stat-row">
      <view class="stat-item">
        <text class="stat-val">{{summary.goalDays}} <text class="stat-unit">天</text></text>
        <text class="stat-label">达标天数</text>
      </view>
      <view class="vertical-line"></view>
      <view class="stat-item">
        <text class="stat-val">{{summary.avgTotalCalories || '--'}} <text class="stat-unit">kcal</text></text>
        <text class="stat-label">日均摄入</text>
      </view>
    </view>
    
    <view class="footer-hint">
       {{summary.netCaloriesHint}}
    </view>
  </view>

  <!-- 3. 每日完成度 (极简条形) -->
  <view class="section-container">
    <view class="section-title-outer">每日追踪</view>
    <view class="glass-card list-card">
      <block wx:if="{{dailyScores.length}}">
        <view class="day-list">
          <view class="day-row" wx:for="{{dailyScores}}" wx:key="date">
             <text class="d-label">{{item.label}}</text>
             <view class="d-bar-track">
                <view class="d-bar-fill" style="width: {{item.scoreWidth}};"></view>
             </view>
             <text class="d-score">{{item.score}}</text>
          </view>
        </view>
      </block>
      <block wx:else>
        <view class="empty-state">本周暂无记录</view>
      </block>
    </view>
  </view>

  <!-- 4. 文字报告 (无表情图标设计) -->
  <view class="section-container">
    <view class="section-title-outer">详细分析</view>
    
    <view class="glass-card text-report-card">
      <!-- 亮点 -->
      <view class="report-block">
        <view class="rb-header">
           <view class="indicator-dot highlight-bg"></view>
           <text class="rb-title-text">本周亮点</text>
        </view>
        <view class="rb-text">{{highlights}}</view>
      </view>
      
      <view class="divider-dash"></view>

      <!-- 改进 -->
      <view class="report-block">
        <view class="rb-header">
           <view class="indicator-dot improve-bg"></view>
           <text class="rb-title-text">可以改进</text>
        </view>
        <view class="rb-text">{{improvements}}</view>
      </view>
      
      <view class="divider-dash"></view>

      <!-- 建议 -->
      <view class="report-block">
        <view class="rb-header">
           <view class="indicator-dot suggest-bg"></view>
           <text class="rb-title-text">下周建议</text>
        </view>
        <view class="rb-text">{{suggestions}}</view>
      </view>
    </view>
  </view>

</view>
