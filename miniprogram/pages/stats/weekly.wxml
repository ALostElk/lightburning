<!-- pages/stats/weekly.wxml -->
<view class="page">

<!-- 周范围 -->
<view class="range-bar">
  <text class="range-text">本周：{{weekRangeText}}</text>
</view>

<!-- 本周总览卡片 -->
<view class="card card--primary">
  <view class="card-header">
    <text class="card-title">一周饮食总览</text>
    <text class="card-sub">达标率 {{summary.goalRate}}%</text>
  </view>

  <view class="card-body summary-row">
    <view class="summary-block">
      <text class="summary-label">达标天数</text>
      <text class="summary-value">{{summary.goalDays}} / {{summary.totalDays}}</text>
    </view>
    <view class="summary-block">
      <text class="summary-label">日均摄入</text>
      <text class="summary-value">
        {{summary.avgTotalCalories != null ? summary.avgTotalCalories : '--'}} kcal
      </text>
    </view>
  </view>

  <view class="card-footer">
    <text class="tag">{{summary.netCaloriesHint}}</text>
  </view>
</view>

<!-- 每日完成度条形图 -->
<view class="card card--plain">
  <view class="card-header">
    <text class="card-title">每日完成度</text>
    <text class="card-sub">记录越完整，分数越高</text>
  </view>

  <block wx:if="{{dailyScores.length}}">
    <view
      class="day-row"
      wx:for="{{dailyScores}}"
      wx:key="date"
    >
      <text class="day-label">{{item.label}}</text>
      <view class="day-progress">
        <view
          class="day-progress-inner"
          style="width: {{item.scoreWidth}};"
        ></view>
      </view>
      <text class="day-score">{{item.score}}</text>
    </view>
  </block>
  <block wx:else>
    <view class="empty">
      <text>本周还没有饮食记录，先从今天开始记录吧～</text>
    </view>
  </block>
</view>

<!-- 文案总结：亮点 / 需要改进 / 建议 -->
<view class="card card--green">
  <view class="card-header">
    <text class="card-title">本周亮点</text>
  </view>
  <view class="text-block">
    <text>{{highlights}}</text>
  </view>
</view>

<view class="card card--orange">
  <view class="card-header">
    <text class="card-title">可以改进的地方</text>
  </view>
  <view class="text-block">
    <text>{{improvements}}</text>
  </view>
</view>

<view class="card card--blue">
  <view class="card-header">
    <text class="card-title">下周小建议</text>
  </view>
  <view class="text-block">
    <text>{{suggestions}}</text>
  </view>
</view>
</view>
