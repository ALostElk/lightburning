<view class="page">

<!-- é¡¶éƒ¨æ€»è§ˆå¡ç‰‡ -->
<view class="summary-card shadow-card">
  <view class="summary-left">
    <view class="ring">
      <text class="ring-main">
        {{avgCaloriesIn ? avgCaloriesIn : '--'}}
      </text>
      <text class="ring-sub">kcal / æ—¥å‡æ‘„å…¥</text>
    </view>
  </view>

  <view class="summary-right">
    <view class="summary-row">
      <view class="dot dot-red"></view>
      <view class="summary-label">æ€»æ‘„å…¥</view>
      <view class="summary-value">{{totalCaloriesIn || 0}}</view>
      <text class="summary-unit">kcal</text>
    </view>
    <view class="summary-row">
      <view class="dot dot-blue"></view>
      <view class="summary-label">è®°å½•å¤©æ•°</view>
      <view class="summary-value">{{recordDays || 0}}</view>
      <text class="summary-unit"> / {{totalDays || 0}}</text>
    </view>
    <view class="summary-row">
      <view class="dot dot-purple"></view>
      <view class="summary-label">è®°å½•å®Œæˆåº¦</view>
      <view class="summary-value">{{recordRate || 0}}</view>
      <text class="summary-unit">%</text>
    </view>
  </view>
</view>

<!-- é€‰æ‹©å‘¨æœŸ -->
<view class="section-header">
  <view class="section-title">é€‰æ‹©å‘¨æœŸ</view>
  <view class="range-tabs">
    <view
      class="range-tab {{rangeDays==7 ? 'active' : ''}}"
      data-days="7"
      bindtap="changeRange"
    >
      è¿‘7å¤©
    </view>
    <view
      class="range-tab {{rangeDays==30 ? 'active' : ''}}"
      data-days="30"
      bindtap="changeRange"
    >
      è¿‘30å¤©
    </view>
    <view
      class="range-tab {{rangeDays==90 ? 'active' : ''}}"
      data-days="90"
      bindtap="changeRange"
    >
      è¿‘90å¤©
    </view>
  </view>
</view>

<!-- æ—¥æœŸåŒºé—´ + è®°å½•æƒ…å†µ -->
<view class="chips-row">
  <view class="chip">
    <text class="chip-icon">ğŸ“…</text>
    <text class="chip-text">{{rangeText}}</text>
  </view>
  <view class="chip">
    <text class="chip-icon">âœ…</text>
    <text class="chip-text">
      å·²è®°å½• {{recordDays || 0}} å¤©ï¼ˆ{{recordRate || 0}}%ï¼‰
    </text>
  </view>
</view>

<!-- === ä¸­é—´å››ä¸ªå¡ç‰‡ï¼šè¿åŠ¨ / ä½“é‡ / è¶‹åŠ¿ / è¥å…» === -->

<!-- è¿åŠ¨ & è¾¾æ ‡ -->
<view class="shadow-card stat-card stat-card-blue" style="margin-top: 16rpx; padding: 20rpx 22rpx;">
  <view style="display:flex; align-items:center; justify-content:space-between;">
    <view style="flex:1;">
      <view style="font-size:26rpx; font-weight:600; color:#27344a;">
        è¿åŠ¨ & è¾¾æ ‡
      </view>
      <view style="margin-top:6rpx; font-size:22rpx; color:#96a3b3;">
        ç›®æ ‡ â‰¥ {{exerciseGoalPerDay}} min/å¤©
      </view>
      <view style="margin-top:2rpx; font-size:22rpx; color:#96a3b3;">
        {{exerciseStatusText}}
      </view>
    </view>
    <view style="margin-left:24rpx; text-align:right;">
      <view style="font-size:30rpx; font-weight:600; color:#1f8cff;">
        {{exerciseMinutesTotal || 0}} min
      </view>
      <view style="font-size:22rpx; color:#8693a5; margin-top:4rpx;">
        æ—¥å‡ {{exerciseAvgMinutes || 0}} min Â· {{exerciseDays || 0}} å¤©
      </view>
    </view>
  </view>
</view>

<!-- ä½“é‡å˜åŒ– -->
<view class="shadow-card stat-card stat-card-green" style="margin-top: 14rpx; padding: 20rpx 22rpx;">
  <view style="display:flex; flex-direction:column;">
    <view style="display:flex; align-items:center; justify-content:space-between;">
      <view style="flex:1;">
        <view style="font-size:26rpx; font-weight:600; color:#27344a;">
          ä½“é‡å˜åŒ–
        </view>
        <view
          wx:if="{{weightStart}}"
          style="margin-top:6rpx; font-size:22rpx; color:#96a3b3;"
        >
          {{weightStart}} kg â†’ {{weightEnd}} kg
        </view>
        <view
          wx:else
          style="margin-top:6rpx; font-size:22rpx; color:#96a3b3;"
        >
          æš‚æ— ä½“é‡è®°å½•
        </view>
      </view>
      <view style="margin-left:24rpx; text-align:right;">
        <view style="font-size:28rpx; font-weight:600; color:#27344a;">
          {{weightChangeText || '--'}}
        </view>
      </view>
    </view>

    <!-- å°æŠ˜çº¿å›¾ -->
    <view style="margin-top:16rpx;">
      <canvas
        canvas-id="weightChart"
        style="width:100%; height:120rpx;"
      ></canvas>
    </view>
  </view>
</view>


<!-- çƒ­é‡è¶‹åŠ¿ -->
<view class="shadow-card stat-card stat-card-purple" style="margin-top: 14rpx; padding: 20rpx 22rpx;">
  <view style="display:flex; align-items:center; justify-content:space-between;">
    <view style="flex:1;">
      <view style="font-size:26rpx; font-weight:600; color:#27344a;">
        çƒ­é‡è¶‹åŠ¿
      </view>
      <view style="margin-top:6rpx; font-size:22rpx; color:#96a3b3;">
        æ—¥å‡ {{avgCaloriesIn || 0}} kcal
      </view>
      <view style="margin-top:2rpx; font-size:22rpx; color:#b0bcc9;">
        æœ€é«˜ {{maxCalories || 0}} Â· æœ€ä½ {{minCalories || 0}} kcal
      </view>
    </view>
    <view style="margin-left:24rpx; text-align:right;">
      <view style="font-size:22rpx; color:#8693a5;">
        è®°å½• {{recordDays || 0}} å¤©
      </view>
    </view>
  </view>
</view>

<!-- è¥å…»ç´ åˆ†å¸ƒ -->
<view class="shadow-card stat-card stat-card-pink" style="margin-top: 14rpx; padding: 20rpx 22rpx;">
  <view style="display:flex; align-items:center; justify-content:space-between;">
    <view style="flex:1;">
      <view style="font-size:26rpx; font-weight:600; color:#27344a;">
        è¥å…»ç´ åˆ†å¸ƒ
      </view>
      <view style="margin-top:6rpx; font-size:22rpx; color:#96a3b3;">
        ç¢³æ°´ {{totalCarbs || 0}} gï¼ˆ{{macroPercentCarb || 0}}%ï¼‰
      </view>
      <view style="margin-top:2rpx; font-size:22rpx; color:#96a3b3;">
        è›‹ç™½è´¨ {{totalProtein || 0}} gï¼ˆ{{macroPercentProtein || 0}}%ï¼‰
      </view>
      <view style="margin-top:2rpx; font-size:22rpx; color:#96a3b3;">
        è„‚è‚ª {{totalFat || 0}} gï¼ˆ{{macroPercentFat || 0}}%ï¼‰
      </view>
    </view>
  </view>
</view>

<!-- æŸ¥çœ‹å‘¨æŠ¥ -->
<view class="weekly-entry" bindtap="goWeeklyReport">
  <text class="weekly-text">æŸ¥çœ‹æœ¬å‘¨è¯¦ç»†æŠ¥å‘Š</text>
  <text class="weekly-arrow">â€º</text>
</view>
</view>
