<!--pages/recipe-detail/index.wxml-->
<view class="container" wx:if="{{!loading}}">
  
  <!-- é¡¶éƒ¨å›¾ç‰‡ -->
  <view class="hero-section">
    <image 
      class="hero-image" 
      src="{{recipe.image}}" 
      mode="aspectFill"
      bindtap="onPreviewImage"
    />
    <view class="hero-overlay">
      <text class="recipe-title">{{recipe.name}}</text>
      <text class="recipe-subtitle">{{recipe.description}}</text>
    </view>
  </view>

  <!-- å¿«æ·æ“ä½œæ  -->
  <view class="action-bar">
    <button class="action-btn" bindtap="onToggleFavorite">
      <text class="action-icon">{{isFavorited ? 'â¤ï¸' : 'ğŸ¤'}}</text>
      <text class="action-text">{{isFavorited ? 'å·²æ”¶è—' : 'æ”¶è—'}}</text>
    </button>
    
    <button class="action-btn" open-type="share">
      <text class="action-icon">ğŸ“¤</text>
      <text class="action-text">åˆ†äº«</text>
    </button>
    
    <button class="action-btn" bindtap="onSaveToMyRecipes">
      <text class="action-icon">ğŸ“‹</text>
      <text class="action-text">ä¿å­˜</text>
    </button>
  </view>

  <!-- è¥å…»ä¿¡æ¯å¡ç‰‡ -->
  <view class="card nutrition-card">
    <view class="card-header">
      <text class="card-title">è¥å…»æˆåˆ†</text>
      <view 
        class="toggle-btn" 
        bindtap="onToggleNutritionDetail"
      >
        <text class="toggle-text">{{showNutritionDetail ? 'æ”¶èµ·' : 'å±•å¼€'}}</text>
        <text class="toggle-icon">{{showNutritionDetail ? 'â–²' : 'â–¼'}}</text>
      </view>
    </view>

    <view class="nutrition-grid">
      <view class="nutrition-main-item">
        <text class="nutrition-main-icon">ğŸ”¥</text>
        <text class="nutrition-main-value">{{recipe.calories}}</text>
        <text class="nutrition-main-label">åƒå¡</text>
      </view>
      <view class="nutrition-main-item">
        <text class="nutrition-main-icon">ğŸ’ª</text>
        <text class="nutrition-main-value">{{recipe.protein}}g</text>
        <text class="nutrition-main-label">è›‹ç™½è´¨</text>
      </view>
      <view class="nutrition-main-item">
        <text class="nutrition-main-icon">ğŸš</text>
        <text class="nutrition-main-value">{{recipe.carbs}}g</text>
        <text class="nutrition-main-label">ç¢³æ°´</text>
      </view>
      <view class="nutrition-main-item">
        <text class="nutrition-main-icon">ğŸ¥‘</text>
        <text class="nutrition-main-value">{{recipe.fat}}g</text>
        <text class="nutrition-main-label">è„‚è‚ª</text>
      </view>
    </view>

    <view wx:if="{{showNutritionDetail}}" class="nutrition-detail">
      <view class="nutrition-highlight">
        <text class="highlight-icon">ğŸ’¡</text>
        <text class="highlight-text">{{recipe.nutritionHighlight}}</text>
      </view>
    </view>
  </view>

  <!-- çƒ¹é¥ªä¿¡æ¯ -->
  <view class="card cooking-card">
    <view class="cooking-info-grid">
      <view class="cooking-info-item">
        <text class="cooking-info-icon">â±ï¸</text>
        <text class="cooking-info-label">çƒ¹é¥ªæ—¶é—´</text>
        <text class="cooking-info-value">{{recipe.cookingTime}}åˆ†é’Ÿ</text>
      </view>
      <view class="cooking-info-item">
        <text class="cooking-info-icon">ğŸ‘¨â€ğŸ³</text>
        <text class="cooking-info-label">éš¾åº¦</text>
        <text class="cooking-info-value">{{recipe.difficulty}}</text>
      </view>
    </view>
  </view>

  <!-- æ ‡ç­¾ -->
  <view class="card tags-card">
    <view class="card-title">ç‰¹è‰²æ ‡ç­¾</view>
    <view class="tags-list">
      <view 
        wx:for="{{recipe.tags}}" 
        wx:key="*this"
        class="tag {{item === 'é«˜è›‹ç™½' ? 'tag-protein' : item === 'ä½å¡' || item === 'ä½è„‚' ? 'tag-lowcal' : item === 'ç´ é£Ÿ' ? 'tag-veg' : ''}}"
      >
        {{item}}
      </view>
    </view>
  </view>

  <!-- é£Ÿææ¸…å• -->
  <view class="card ingredients-card">
    <view class="card-header">
      <text class="card-title">ğŸ›’ é£Ÿææ¸…å•</text>
      <button class="copy-btn" bindtap="onCopyIngredients">
        <text class="copy-icon">ğŸ“‹</text>
        <text>å¤åˆ¶</text>
      </button>
    </view>
    
    <view class="ingredients-list">
      <view 
        wx:for="{{recipe.ingredients}}" 
        wx:key="name"
        class="ingredient-item"
      >
        <view class="ingredient-info">
          <text class="ingredient-name">{{item.name}}</text>
          <text class="ingredient-amount">{{item.amount}}</text>
        </view>
        <text class="ingredient-calories">{{item.calories}}å¡</text>
      </view>
    </view>
  </view>

  <!-- çƒ¹é¥ªæ­¥éª¤ -->
  <view class="card steps-card">
    <view class="card-title">ğŸ‘©â€ğŸ³ çƒ¹é¥ªæ­¥éª¤</view>
    
    <view class="steps-list">
      <view 
        wx:for="{{recipe.steps}}" 
        wx:key="*this"
        class="step-item"
      >
        <view class="step-number">{{index + 1}}</view>
        <text class="step-content">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
  <view class="bottom-actions">
    <button class="btn-primary start-cooking-btn" bindtap="onStartCooking">
      <text class="btn-icon">ğŸ”ª</text>
      <text>å¼€å§‹çƒ¹é¥ª</text>
    </button>
  </view>

</view>

<!-- åŠ è½½ä¸­ -->
<view wx:if="{{loading}}" class="loading-container">
  <view class="loading-spinner"></view>
  <text class="loading-text">åŠ è½½ä¸­...</text>
</view>

